# Core functions like backward_pass and forward_pass should be moved here.